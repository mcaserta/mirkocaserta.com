{% extends "base.html" %}

{% block content %}
<div class="container">
    <header class="section-header">
        <h1 class="section-title">
            {%- if taxonomy.name == "categories" %}Blog posts in "{{ term.name }}"
            {%- elif taxonomy.name == "tags" %}Blog posts tagged "{{ term.name }}"
            {%- else %}{{ term.name | title }}
            {%- endif -%}
        </h1>
        
        <p class="section-description">
            {{ term.pages | length }}
            {%- if term.pages | length == 1 %} post found
            {%- else %} posts found
            {%- endif -%}
        </p>
    </header>
    
    {%- if term.pages %}
    <section class="posts-section">
        <div class="posts-grid">
            {%- for post in term.pages %}
            <article class="post-card">
                {%- if post.extra.featured_image %}
                <div class="post-image">
                    <img src="{{ get_url(path=post.extra.featured_image) }}" alt="{{ post.title }}" loading="lazy">
                </div>
                {%- endif %}

                <div class="post-content">
                    <h3 class="post-title">
                        <a href="{{ post.permalink }}">{{ post.title }}</a>
                    </h3>

                    <div class="post-meta">
                        <time datetime="{{ post.date }}">
                            {{ post.date | date(format="%B %d, %Y") }}
                        </time>

                        {%- if taxonomy.name == "tags" and post.taxonomies.categories %}
                        <div class="post-categories">
                            {%- for category in post.taxonomies.categories %}
                            <a href="/categories/{{ category | slugify }}/" class="category-link">
                                {{ category }}
                            </a>
                            {%- endfor %}
                        </div>
                        {%- endif %}
                    </div>

                    {%- if post.summary %}
                    <p class="post-summary">{{ post.summary }}</p>
                    {%- elif post.description %}
                    <p class="post-summary">{{ post.description }}</p>
                    {%- endif %}

                    {%- if taxonomy.name == "categories" and post.taxonomies.tags %}
                    <div class="post-tags">
                        {%- for tag in post.taxonomies.tags | slice(end=3) %}
                        <a href="/tags/{{ tag | slugify }}/" class="tag-link">
                            #{{ tag }}
                        </a>
                        {%- endfor %}
                    </div>
                    {%- endif %}
                </div>
            </article>
            {%- endfor %}
        </div>
    </section>
    
    {%- if paginator %}
    <nav class="pagination">
        {%- if paginator.previous %}
        <a href="{{ paginator.previous }}" class="pagination-link pagination-prev">← Newer posts</a>
        {%- endif %}
        
        <span class="pagination-info">Page {{ paginator.current_index }} of {{ paginator.number_pagers }}</span>
        
        {%- if paginator.next %}
        <a href="{{ paginator.next }}" class="pagination-link pagination-next">Older posts →</a>
        {%- endif %}
    </nav>
    {%- endif %}
    
    {%- else %}
    <div class="empty-state">
        <p class="empty-message">No posts found.</p>
    </div>
    {%- endif %}
    
    <div class="section-nav">
        <a href="/{{ taxonomy.name }}/" class="button button-secondary">
            {%- if taxonomy.name == "categories" %}← All categories
            {%- elif taxonomy.name == "tags" %}← All tags
            {%- endif -%}
        </a>
    </div>
</div>
{% endblock content %}